{# https://github.com/miyadaiku/miyadaiku/blob/master/miyadaiku/themes/base/templates/base.html #}
{% extends 'miyadaiku.themes.base!base.html' %}

{% block title %}{% if not page.get_config('no_page_title', false) %}{{ page.title | striptags }} - {% endif %}{{ page.site_title | striptags }}{% endblock %}

{% macro article_metadata(article) %}

<div class="article-metadata">
  <div class="article-date">
    {{ article.date.strftime("%Y-%m-%d") if article.date else "" }}
    {{ article.updated.strftime("(updated: %Y-%m-%d)") if article.updated and article.date != article.updated else "" }}
  </div>

  <div class="article-tags">
{% if article.category %}
    <a href="{{ page.path_to('/blog/index_category.yml', group_value=article.category, npage=1).replace('/index.html', '/') }}" class="article-category">
      {{ article.category }}
    </a>
{% endif %}

{% for tag in article.tags %}
    <a href="{{ page.path_to('/blog/index_tag.yml', group_value=tag, npage=1).replace('/index.html', '/') }}" class="article-tag">
      {{ tag }}
    </a>
{% endfor %}
  </div>

</div>

{% endmacro %}


{# https://github.com/miyadaiku/miyadaiku/blob/master/miyadaiku/themes/sample/blog/templates/blog_macros.html #}
{% macro index_pagination(page, group_value, num_pages, cur_page, is_last) %}

  <div class="index-pagination">
    {% if cur_page != 1 %}
      <a class="index-pagination-button"
         href="{{ page.path_to(page, group_value=group_value, npage=1) }}">⇤</a>
      <a class="index-pagination-button"
         href="{{ page.path_to(page, group_value=group_value, npage=cur_page-1) }}">←</a>
    {% else %}
      <span class="index-pagination-button index-pagination-button-disabled">⇤</span>
      <span class="index-pagination-button index-pagination-button-disabled">←</span>
    {% endif %}


    {% set s = cur_page-2 if cur_page > 2 else 1 %}
    {% set e = s+4 if s+4 <= num_pages else num_pages %}
    {% if (s-e) < 4 %}
      {% set s = e-4 if e > 4 else 1 %}
    {% endif %}

    {% if s != 1 %}
       ・・・
    {% endif %}

    {% for n in range(s, e+1) %}
      {% if n != cur_page %}
        <a class="index-pagination-button"
          href="{{ page.path_to(page, group_value=group_value, npage=n) }}">{{ n }}</a>
      {% else %}
        <span class="index-pagination-button index-pagination-button-current">{{ n }}</span>
      {% endif %}
    {% endfor %}

    {% if e != num_pages %}
       ・・・
    {% endif %}

    {% if not is_last %}
      <a class="index-pagination-button"
         href="{{ page.path_to(page, group_value=group_value, npage=cur_page+1) }}">→</a>
      <a class="index-pagination-button"
         href="{{ page.path_to(page, group_value=group_value, npage=num_pages) }}">⇥</a>
    {% else %}
      <span class="index-pagination-button index-pagination-button-disabled">→</span>
      <span class="index-pagination-button index-pagination-button-disabled">⇥</span>
    {% endif %}
  </div>

{% endmacro %}




{% block head %}
{{ super().rstrip() }}

{% from 'macros/meta_favicon.html' import meta_favicon %}
{{ meta_favicon(page).strip() }}

{# https://github.com/miyadaiku/miyadaiku/blob/master/miyadaiku/themes/base/templates/macros.html #}
{{ macros.opengraph(page, abstract_length=128).strip() }}

{% from 'macros/meta_keywords.html' import meta_keywords %}
{{ meta_keywords(page).strip() }}

{% from 'macros/twitter_card.html' import twitter_card %}
{{ twitter_card(page).strip() }}

<link href="{{ page.load('/blog/atom.yml').url }}" type="application/atom+xml" rel="alternate" title="{{ page.site_title }} Atom Feed" />
<link href="{{ page.load('/blog/rss.yml').url }}" type="application/rss+xml" rel="alternate" title="{{ page.site_title }} RSS Feed" />

<link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
<link rel="stylesheet" href="{{ page.path_to('/static/aoirint-blog/css/style.css') }}">

{{ fontawesome.load_css(page) }}
{{ pygments.load_css(page) }}

{{ macros.google_analytics().strip() }}

<script src="{{ page.path_to('/static/aoirint-blog/js/main.js') }}"></script>

<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
{% endblock head %}

{% block body %}

<nav class="sitebar">
  {% if page.get_config('custom_search_engine_id', None) %}
  <a href="https://cse.google.com/cse?cx={{ page.custom_search_engine_id }}" target="_blank" class="sitebar-button">
    <i class="fas fa-search"></i>
  </a>
  {% endif %}

  <a href="{{ page.path_to('/blog/atom.yml') }}" title="RSS Feed" class="sitebar-button">
    <i class="fas fa-rss"></i>
  </a>

  {% if page.get_config('twitter_name', None) %}
  <a href="https://twitter.com/{{ page.twitter_name }}" target="_blank" title="Twitter @{{ page.twitter_name }}" class="sitebar-button">
    <i class="fab fa-twitter"></i>
  </a>
  {% endif %}

  {% if page.get_config('github_name', None) %}
  <a href="https://github.com/{{ page.github_name }}" target="_blank" title="GitHub @{{ page.twitter_name }}" class="sitebar-button">
    <i class="fab fa-github"></i>
  </a>
  {% endif %}

  {% if page.get_config('author_url', None) %}
  <a href="{{ page.path_to('/index.md') }}" title="Home" class="sitebar-button">
    <i class="fas fa-home"></i>
  </a>
  {% endif %}

  <div class="sitebar-title-box">
    <a href="{{ page.path_to('/blog/index.md') }}" class="sitebar-title">
      {{ page.site_title | striptags }}
    </a>
    {% if page.get_config('site_description', None) %}
    <div class="sitebar-description">
      {{ page.site_description | striptags }}
    </div>
    {% endif %}
  </div>

  <button class="toggle-tocbar sitebar-button" type="button" onclick="toggleTocBarIfSmartphone();">
    <i class="fas fa-list"></i>
  </button>

</nav>

<main class="main-content">
{% block content %}
{% endblock content %}
</main>

<aside class="tocbar-box">
  <nav class="tocbar fixed-scrollable">
{% block tocbar %}
{% endblock tocbar %}
  </nav>
</aside>

<footer class="footer">
{% if page.get_config('copyright', None) %}
  <p class="copyright-text">
    {{ page.copyright }}
{% endif %}
  <p class="theme-text">
    Theme
    <a href="https://github.com/aoirint/aoirint-miyadaiku-theme-blog">aoirint-miyadaiku-theme-blog</a>.
  <p class="poweredby-text">
    Powered by
    <a href="https://github.com/miyadaiku/miyadaiku">Miyadaiku</a>.
</footer>

{% endblock body %}
